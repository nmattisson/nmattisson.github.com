/*! jQuery Gallery - 2013-12-27
* https://github.com/nmattisson
* Copyright (c) 2013 Nils Mattisson - MIT License */
!function(t){function h(h,i,n){var e=n.rowLength/i,a=0;n.container.append(t("<div>").addClass("photo-row").css("margin-bottom",n.margin+"px")),t.each(h,function(i,r){t(r).width(Math.round(t(r).width()*e)),t(r).height(Math.round(t(r).height()*e));var o=n.margin;if(i==h.length-1&&(t(r).width(n.rowLength-a),o=0),a+=t(r).width(),a+=o,t(r).width()>r.width){var g=Math.max(t(r).width(),t(r).height()),d=new Image;t(d).width(t(r).width()),t(d).height(t(r).height()),d.src=t.fn.getPhotoURL(r.src,g),r=d}n.container.find(".photo-row:last-child").css("height",Math.min(t(r).height(),t(this).height())+"px").append(t("<div>").addClass("photo").css("height",t(r).height()+"px").css("width",t(r).width()+"px").css("margin-right",o+"px").css("display","inline-block").append(t("<a>").attr("href",t.fn.getFlickrURL(r.src)).append(r)))})}t.fn.gallery=function(i,n){var e=t.extend(t.fn.gallery.defaults,i);e.container=this;var a=n.length,r=[],o=0;t.each(n,function(i,n){var g=new Image;t(g).on("load",function(){var i=Math.round(this.width/this.height*e.rowHeight);t(this).height(e.rowHeight),t(this).width(i),o+i>e.rowLength?(h(r,o,e),o=i+e.margin,r=[this]):(o+=i+e.margin,r.push(this)),a--,0==a&&h(r,o,e)}).attr({src:t.fn.getPhotoURL(n,2*e.rowHeight)}).error(function(){})})},t.fn.gallery.defaults={rowLength:640,rowHeight:120,margin:1,container:null}}(jQuery);
